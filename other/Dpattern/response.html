<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script>
        var Order500 = function(orderType, pay, stock) {
            if(orderType === 1 && pay === true){
                console.log('100');
            }else{
                return 'nextSuccessor';
            }
        }

        var Order200 = function(orderType, pay, stock) {
            if(orderType === 2 && pay === true){
                console.log('50');
            }else{
                return 'nextSuccessor';
            }
        }

        var OrderNormal = function(orderType, pay, stock) {
            if(stock > 0){
                console.log('0');
            }else{
                console.log('no');
            }
        }

        var Chain = function(fn){
            this.fn = fn;
            this.successor = null;
        }

        Chain.prototype.setNextSuccessor = function(successor){
            return this.successor = successor;
        }

        Chain.prototype.passRequest = function(){
            var ret = this.fn.apply(this, arguments);//改变参数格式
            if(ret === 'nextSuccessor'){
                // return this.successor && this.successor.passRequest.apply(this.successor, arguments);
                return this.successor && this.successor.passRequest(...arguments);
            }

            return ret ; 
        }

        var chainOrder500 = new Chain(Order500);
        var chainOrder200 = new Chain(Order200);
        var chainOrderNormal = new Chain(OrderNormal);

        //指定责任链顺序
        chainOrder500.setNextSuccessor(chainOrder200);
        chainOrder200.setNextSuccessor(chainOrderNormal);

        chainOrder500.passRequest(1, true, 500);
        chainOrder500.passRequest(2, true, 500);
        chainOrder500.passRequest(3, true, 500);
        chainOrder500.passRequest(1, false, 0);


    </script>
</head>

<body>

</body>

</html>